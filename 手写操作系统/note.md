## 0.11什么是平坦模型
平坦模型是相对于多段模型来说的，所以说平坦模型指的就是一个段。比如在实模式下，访问超过 64KB 的内存，需要重新指定不同的段基址，通过这种迂回变通的方式才能达到目的。在保护模式下， 由于其是 32 位的，寻址范围便能够达到 4GB，段内偏移地址也是地址，所以也是 32 位。可见，在 32 位环境下用一个段就能够访问到硬件所支持的所有内存。也就是说，段的大小可以是地址总线能够到达 的范围。既然平坦模型是相对于多段模型来说的，为什么不称为单段模型，而称为平坦呢，我估计很多 读者已经明白了，用多个小段再加上不断换段基址的方式访问内存确实够麻烦的，可能换着换着就晕了， 别忘记了，这种多段模型为了访问到 1MB 地址空间，还需要额外打开 A20 地址线呢，这种访存方式本 身就是种补救措施，相当于给硬件打了个补丁，既然是补丁，访问内存的过程必然是不顺畅的。相对于 那么麻烦的多段模型，平坦模型不需要额外打开 A20 地址线，不需要来回切换段基址就可以在地址空间 内任意翱翔。如果把内存段比喻成小格子的话，平坦模型下的内存访问，没有众多小格子成为羁绊，可 谓一路“平坦”。
所以“平坦”这两个字，突显了当时的程序员受多段模型折磨之苦，迫不及待地想表达其优势的喜 悦之情。
CPU 中存在段寄存器是因为其内存是分段访问的，这是设计之初决定的，属于基因里的东西。前面 已经介绍过了内存分段访问的方法，这里不再赘述。
CPU 内部的段寄存器(Segment reg)如下。
(1)CS— 代码段寄存器(Code Segment Register)，其值为代码段的段基值。  

## 0.12cs、ds 这类 sreg 段寄存器，位宽是多少

(2)DS— 数据段寄存器(Data Segment Register)，其值为数据段的段基值。
(3)ES— 附加段寄存器(Extra Segment Register)，其值为附加数据段的段基值，称为“附加”是 因为此段寄存器用途不像其他 sreg 那样固定，可以额外做他用。
(4)FS— 附加段寄存器(Extra Segment Register)，其值为附加数据段的段基值，同上，用途不固定， 使用上灵活机动。
(5)GS— 附加段寄存器(Extra Segment Register)，其值为附加数据段的段基值。 (6)SS— 堆栈段寄存器(Stack Segment Register)，其值为堆栈段的段值。
32 位 CPU 有两种不同的工作模式:实模式和保护模式。
每种模式下，段寄存器中值的意义是不同的，但不管其为何值，在段寄存器中所表达的都是指向的段 在哪里。在实模式下，CS、DS、ES、SS 中的值为段基址，是具体的物理地址，内存单元的逻辑地址仍为
“段基值:段内偏移量”的形式。在保护模式下，装入段寄存器的不再是段地址，而是“段选择子”(Selector)， 当然，选择子也是数值，其依然为 16 位宽度。
可见，在 32 位 CPU 中，sreg 无论是工作在 16 位的实模式，还是 32 位的保护模式，用的段寄存器都 是同一组，并且在 32 位下的段选择子是 16 位宽度，排除了段寄存器在 32 位环境下是 32 位宽的可能，综 上所述，sreg 都是 16 位宽。